# SDFT.jl

A code companion for [![DOI](https://img.shields.io/badge/DOI-10.48550/arXiv.2510.15369-blue)](https://doi.org/10.48550/arXiv.2510.15369), which utilizes the stochastic density functional theory (sDFT) combined with a multilevel Monte Carlo framework to efficiently evaluate the electron density under plane-wave discretization. This approach significantly decreases the variance while avoiding the computationally expensive diagonalization process.


## Installation
SDFT.jl is an unregistered package and therefore needs to be downloaded or cloned to the user's local computer first, and then installed by running

```julia
julia> cd("your-local-path/SDFT.jl")
julia> using Pkg
julia> Pkg.activate(".")
julia> Pkg.instantiate()
```

## Usage
Here are some examples showing how to use the packge.

```julia
using SDFT
using DFTK

# Define the model and basis
Ecut = 10
temperature = 1e-1
supercell_size = [1,1]
basis = graphene_setup(supercell_size; Ecut, temperature);

ρ = guess_density(basis);
εF = 0.0;

# Compute density using Chebyshev expansion with a complete basis set
ρct = compute_stoc_density(basis, εF, CT(); ρ);

# Compute density using sDFT
ns = 100 # number of stochastic orbitals
ρmc = compute_stoc_density(basis, εF, MC(ns); ρ);

# Compute density using MLMC-sDFT for multilevel polynomial orders
nsl = fill(100, 2) # initial number of stochastic orbitals with 2 levels
ρpd = compute_stoc_density(basis, εF, PDegreeML(nsl); ρ);

# Compute density using MLMC-sDFT for multilevel energy cutoffs
nsl = fill(100, 2) # initial number of stochastic orbitals with 2 levels
ρec = compute_stoc_density(basis, εF, ECutoffML(basis, nsl); ρ);
```


## Data
The data supporting all figures in [![DOI](https://img.shields.io/badge/DOI-10.48550/arXiv.2510.15369-blue)](https://doi.org/10.48550/arXiv.2510.15369) are provided in the `plots/data` folder. All figures can be generated by running

```julia
julia> include("plots/generate_plots.jl")
```

